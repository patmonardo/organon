import type { Chunk, LogicalOperation } from '../essence'

/*
  Doctrine of the Concept — C. THE SINGULAR (Part 1)
  Two-fold representation:
  - text: verbatim source segmented into readable chunks (preserve lines)
  - concise: short IR summary to support HLO extraction (non-destructive)
*/

export const CANONICAL_CHUNKS: Chunk[] = [
  {
    id: 'con-sing-1-from-particularity',
    title: 'Singularity already posited through particularity',
    text: `C. THE SINGULAR

Singularity, as we have seen, is
already posited through particularity;
this is determinate universality
and hence self-referring determinateness,
the determinate determinate.`,
    concise: 'Singularity flows from particularity: determinate universality → self-referring determinateness.'
  },
  {
    id: 'con-sing-2-self-mediation-and-false-abstraction',
    title: 'Self-mediation; inward/outward shine; false abstraction vs true singularity',
    text: `1. At first, therefore, singularity appears
as the reflection of the concept
out of its determinateness into itself.
It is the concept's self-mediation by virtue of which,
since its otherness has once more been made into an other,
it restores itself as self-equal,
but in the determination of absolute negativity.
The negative in the universal,
by virtue of which this universal is a particular,
was earlier determined as a doubly reflective shine.
In so far as the reflective shining is inward,
the particular remains a universal;
through the outward shining,
it is a determinate particular;
the turning back of this side
into the universal is twofold,
either by virtue of an abstraction
that lets the particular fall away
and climbs to a higher and the highest genus,
or by virtue of the singularity
to which the universality in
the determinateness itself descends.
Here is where the false start is made
that makes abstraction stray away
from the way of the concept,
abandoning the truth.
Its higher and highest universal
to which it rises is  only a surface
that becomes progressively more void of content;
the singularity which it scorns is
the depth in which the concept grasps itself
and where it is posited as concept.`,
    concise: 'Singularity = self-mediation (negation of negation). Inward/outward shine: abstraction climbs to empty genera (false), while true singularity is the depth where concept posits itself.'
  },
  {
    id: 'con-sing-3-universal-particular-total-concept',
    title: 'U and P as total concept; abstraction excludes singularity',
    text: `Universality and particularity appeared, on the one hand,
as moments of the becoming of singularity.
But it has already been shown that the two are
in themselves the total concept;
consequently, that in singularity they do
not pass over into an other
but that, on the contrary,
what is posited in it is
what they are in and for themselves.
The universal is for itself because it
is absolute mediation in itself,
self-reference only as absolute negativity.
It is an abstract universal
inasmuch as this sublating is an external act
and so a dropping off of the determinateness.
This negativity, therefore, attaches indeed
to the abstract universal,
but it remains outside it,
as a mere condition of it;
it is the abstraction itself
that holds its universal opposite it,
and so the universal does not
have singularity in itself
and remains void of concept.
Life, spirit, God, as well as the pure concept,
are for this reason beyond the grasp of abstraction,
for abstraction keeps singularity away from its products,
and singularity is the principle of
individuality and personality.
And so it comes to nothing but lifeless universalities,
void of spirit, color, and content.`,
    concise: 'U and P are the total concept; in S they are what they are in-and-for-themselves. Abstraction drops determinateness and excludes singularity, yielding lifeless universals.'
  },
  {
    id: 'con-sing-4-abstraction-produces-singulars',
    title: 'Abstraction’s products are singulars; concrete unity appears',
    text: `But the unity of the concept is so indissoluble
that these products of abstraction also,
though they are supposed to drop singularity,
are rather themselves singulars.
For in elevating the concrete to universality,
abstraction grasps the universal
as only a determinate universality,
and this is precisely the singularity
that presented itself as self-referring determinateness.
Thus abstraction is a partitioning of the concrete
and an isolating of its determinations;
only singular properties or moments are picked out by it,
for its product must contain what it itself is.
But the difference between this
singularity of its products
and the singularity of the concept is
that in the former the singular and the universal differ
from each other as content and form respectively,
precisely because the content is not the absolute form,
is not the concept itself,
or this form is not the totality of form.
However, this closer consideration shows
that the product of abstraction is
itself the unity of the singular content
and of abstract universality,
therefore that it is something concrete,
the opposite of what it is supposed to be.`,
    concise: 'Abstraction isolates determinations and yields singular products (content/form split), yet these are concrete unities of singular content and abstract universality.'
  },
  {
    id: 'con-sing-5-particular-equals-singular',
    title: 'Particular is also singular (and vice versa); three particular determinations',
    text: `The particular, for the same reason that
makes it only a determinate universal,
is also a singular, and conversely,
because the singular is a determinate universal,
it is equally a particular.
If we stay at this abstract determinateness,
then the concept has the
three particular determinations of
universal, particular, and singular,
whereas earlier we gave only
the universal and the particular as
species of the particular.
Because singularity is the turning of
the concept as a negative back to itself,
this turning back from abstraction,
which in the turning is truly sublated,
can itself be placed as an indifferent
moment alongside the others
and be counted with them.`,
    concise: 'P ↔ S as determinate universals. If kept abstract, concept has three particular determinations (U, P, S).'
  },
  {
    id: 'con-sing-6-particularity-as-totality-middle-term',
    title: 'Particularity as totality (concretion) and as immediate unity (middle term)',
    text: `If singularity is listed as one of the
particular determinations of the concept,
then particularity is the totality
which embraces them all
and, precisely as this totality,
it is the concretion of the determinations
or singularity itself.
But it is a concrete also according
to the previously mentioned side,
as determinate universality;
and then it is the immediate unity
in which none of these moments is posited
as distinct or as the determinant,
and in this form it will constitute
the middle term of the formal syllogism.`,
    concise: 'Treating S as one determination: particularity = embracing totality (concretion), also immediate unity (as determinate universality) → middle term of formal syllogism.'
  },
  {
    id: 'con-sing-7-dissolution-of-distinctions',
    title: 'Every distinction dissolves; counting (quantity) is inappropriate',
    text: `It follows that each of the determinations
established in the preceding exposition of the concept
has immediately dissolved itself
and has lost itself in its other.
Each distinction is confounded
in the course of the very reflection
that should isolate it and hold it fixed.
Only a way of thinking that is merely representational,
for which abstraction has isolated them,
is capable of holding the universal, the particular,
and the singular rigidly apart.
Then they can be counted;
and for a further distinction
this representation relies on one
which is entirely external to being,
on their quantity,
and nowhere is such a distinction as inappropriate as here.`,
    concise: 'Determinations dissolve into each other; only representational thinking isolates and “counts” U/P/S. Quantitative distinction is misplaced here.'
  },
  {
    id: 'con-sing-8-negation-of-negation-totality',
    title: 'S as negation of negation: each determination is totality',
    text: `In singularity, the earlier true relation,
the inseparability of the determinations of the concept,
is posited;
for as the negation of negation,
singularity contains the opposition
of those determinations
and this opposition itself at its ground
or the unity where the determinations have
come together, each in the other.
Because in this reflection
universality is in and for itself,
singularity is essentially the negativity of
the determinations of the concept,
but not merely as if it stood as
a third something distinct from them,
but because what is now posited is
that positedness is being-in-and-for-itself;
that is, what is posited is that
each of the distinct determinations is the totality.
The turning back of the determinate concept into itself
means that its determination is to be
in its determinateness the whole concept.`,
    concise: 'S posits inseparability: as negation of negation, it grounds opposition in unity. Each distinct determination is the totality; determinateness is the whole concept.'
  },
  {
    id: 'con-sing-9-externalization-actuality',
    title: 'Singularity externalizes the concept into actuality; posited abstraction fixes difference',
    text: `2. Singularity is not, however, only the turning back
of the concept into itself, but the immediate loss of it.
Through singularity, where it is internal to itself,
the concept becomes external to itself and steps into actuality.
Abstraction, which is the soul of singularity
and so the self-reference of the negative,
is, as we have seen, nothing external to
the universal and the particular
but is immanent in them,
and these are concreted through it,
they become a content, a singular.
But, as this negativity, singularity is
the determinate determinateness, differentiation as such,
and through this reflection of the difference into itself,
the difference becomes fixed;
the determining of the particular occurs
only by virtue of singularity,
for singularity is that abstraction which,
precisely as singularity,
is now posited abstraction.`,
    concise: 'Singularity makes the concept actual: as immanent abstraction it concretizes U and P into content; fixes difference as determinate determinateness (posited abstraction).'
  },
  {
    id: 'con-sing-10-this-exclusion-commonality',
    title: 'Singular as qualitative “this”: exclusivity; lowest view of universal as commonality',
    text: `The singular, therefore, is as self-referring negativity
the immediate identity of the negative with itself;
it exists for itself.
Or it is the abstraction determining
the concept as an immediate,
according to its ideal moment of being.
Thus the singular is a one which is qualitative, or a this.
In accordance with this qualitative character, it is,
first, the repulsion of itself from itself
by virtue of which many other ones are presupposed;
second, it is now a negative reference
with respect to these presupposed others,
and to this extent the singular is exclusive.
Universality, when referred to
these singulars as indifferent ones
and it must be referred to them,
for they are a moment of the concept of singularity,
is only their commonality.
If by the universal one understands
that which is common to several singulars,
the indifferent subsistence of these singulars is
then taken as the starting point,
thus mixing in the immediacy of being
into the determination of the concept.
The lowest conception one can have of
the universal as connected with the singular
is this external relation that it has
to the latter as a mere commonality.`,
    concise: 'Singular = qualitative this: repulsion presupposes many; exclusive toward others. Universal taken as mere commonality of indifferent singulars is the lowest, external view.'
  },
  {
    id: 'con-sing-11-this-vs-singular-mediation',
    title: '“This” as posited immediacy (pointing-at) vs singular as mediated-immediate within itself',
    text: `The singular, which in the reflective sphere
of concrete existence is as a this,
does not have the excluding reference
to the other that is characteristic
of qualitative being-for-itself.
A this is a one reflected into itself, without repulsion;
or the repulsion is in this reflection one with abstraction,
a reflective mediation present in the this
that makes it a posited immediacy
pointed at by someone external to it.
The this is; it is immediate, it is a this,
however, only in so far as it is pointed at.
This “pointing at” is the reflective movement
that takes hold of itself and posits the immediacy,
but as something external to itself.
Now the singular surely is also a this,
as an immediate which is the result of mediation,
but does not have this mediation outside it;
it is itself repelling separation, posited abstraction,
yet is, precisely in its separation, a positive connection.`,
    concise: '“This” is posited immediacy via external pointing. The singular is also a this, but its mediation is internal: self-separating abstraction that is simultaneously positive connection.'
  },
  {
    id: 'con-sing-12-posited-differences-essential-relation',
    title: 'Singularity posits self-subsisting differences; essential relation (not mere plurality)',
    text: `This act of abstraction by the singular is,
as the immanent reflection of difference,
the first positing of the differences as self-subsisting,
reflected into themselves.
They exist immediately;
but, further, this separating is reflection in general,
the reflective shining of one in the other;
the differences thus stand in essential relation.
They are, moreover, not singulars that
just exist next to each other;
a plurality of this kind belongs to being;
the singularity that posits itself as determinate
does not posit itself in an external difference
but in a difference of the concept;
singularity thus excludes the universal from itself,
but since this universal is a moment of it,
it refers to it just as essentially.`,
    concise: 'Singularity posits self-subsisting differences in essential relation (not mere plurality). It excludes the universal yet refers to it as an essential moment.'
  },
  {
    id: 'con-sing-13-judgment-emergence',
    title: 'Concept loses posited unity; determinate becomes totality; singularity posited as judgment',
    text: `The concept, as this connection of
its self-subsistent determinations,
has lost itself,
for the concept itself is no longer
the posited unity of these determinations,
and these no longer are moments,
the reflective shining of the concept,
but subsist rather in and for themselves.
As singularity, the concept returns
in determinateness into itself,
and therewith the determinate has
itself become totality.
The concept's turning back into itself is
thus the absolute, originative partition of itself,
that is, as singularity it is posited as judgment.`,
    concise: 'Self-subsistent determinations mean the concept loses its posited unity; the determinate becomes totality. Turning-back as singularity = absolute, originative partition → judgment.'
  }
]

export const LOGICAL_OPERATIONS: LogicalOperation[] = [
  {
    id: 'con-sing-op-1-from-particularity',
    chunkId: 'con-sing-1-from-particularity',
    label: 'Singularity posited through particularity',
    candidateSummary: 'Particularity as determinate universality yields self-referring determinateness: singularity.',
    clauses: [
      'assert(positedThrough(Singularity, Particularity))',
      'tag(Particularity,"determinate-universality→self-referring-determinateness")'
    ],
    predicates: [{ name: 'SingularityFromParticularity', args: [] }],
    relations: [{ predicate: 'yields', from: 'Particularity', to: 'Singularity' }]
  },
  {
    id: 'con-sing-op-2-self-mediation',
    chunkId: 'con-sing-2-self-mediation-and-false-abstraction',
    label: 'Self-mediation; inward/outward shine; abstraction vs singularity',
    candidateSummary: 'S = self-mediation (negation of negation). Inward: P stays U; outward: determinate P. Abstraction climbs to empty genera; true S is depth where concept posits itself.',
    clauses: [
      'tag(Singularity,"self-mediation/absolute-negativity")',
      'annotate(ReflectiveShine,{inward:true, outward:true})',
      'assert(falsePath(Abstraction,"higher genera → emptier content"))',
      'assert(trueDepth(Singularity,"concept-posited-as-concept"))'
    ],
    predicates: [{ name: 'ContrastsAbstractionAndSingularity', args: [] }],
    relations: [
      { predicate: 'turnsBackInto', from: 'OutwardSide', to: 'Universal' }
    ]
  },
  {
    id: 'con-sing-op-3-u-p-total-concept',
    chunkId: 'con-sing-3-universal-particular-total-concept',
    label: 'U and P as total concept; abstraction void of concept',
    candidateSummary: 'U and P are total concept and in S are what they are in-and-for-themselves. Abstraction excludes S → lifeless universals (void of concept).',
    clauses: [
      'assert(totalConcept(["Universal","Particular"]))',
      'tag(Abstraction,"excludes-singularity→void-of-concept")'
    ],
    predicates: [{ name: 'TotalConceptAndAbstractionLimit', args: [] }],
    relations: [
      { predicate: 'excludes', from: 'Abstraction', to: 'Singularity' }
    ]
  },
  {
    id: 'con-sing-op-4-abstraction-produces-singulars',
    chunkId: 'con-sing-4-abstraction-produces-singulars',
    label: 'Abstraction isolates; its products are singular yet concrete',
    candidateSummary: 'Abstraction partitions and picks singular moments; product = unity of singular content and abstract universality (concrete).',
    clauses: [
      'assert(partitions(Abstraction, Concrete) && isolates(Abstraction, Determinations))',
      'tag(Products,"singular-and-concrete")'
    ],
    predicates: [{ name: 'AbstractIsolationYieldsConcrete', args: [] }],
    relations: [
      { predicate: 'unifies', from: 'Product', to: 'SingularContent~AbstractUniversality' }
    ]
  },
  {
    id: 'con-sing-op-5-p-is-s',
    chunkId: 'con-sing-5-particular-equals-singular',
    label: 'Particular = singular as determinate universal; three determinations counted',
    candidateSummary: 'P is S (both determinate universals). Counting gives U, P, S as particular determinations.',
    clauses: [
      'assert(equivalent(Particular, Singularity, inSense:"determinate-universal"))',
      'assert(countedDeterminations(Concept) == ["U","P","S"])'
    ],
    predicates: [{ name: 'EquateParticularAndSingular', args: [] }],
    relations: [{ predicate: 'countsAs', from: 'Representation', to: 'U|P|S' }]
  },
  {
    id: 'con-sing-op-6-particularity-totality-middle',
    chunkId: 'con-sing-6-particularity-as-totality-middle-term',
    label: 'Particularity as embracing totality and middle term',
    candidateSummary: 'With S listed, particularity = concretion/totality; as determinate universality it is immediate unity → middle term of formal syllogism.',
    clauses: [
      'tag(Particularity,"embracing-totality/concretion")',
      'assert(actsAsMiddleTerm(Particularity, in:"formal-syllogism"))'
    ],
    predicates: [{ name: 'ParticularityAsMiddle', args: [] }],
    relations: [
      { predicate: 'mediates', from: 'Particularity', to: 'Universal~Singular' }
    ]
  },
  {
    id: 'con-sing-op-7-no-quantitative-counting',
    chunkId: 'con-sing-7-dissolution-of-distinctions',
    label: 'Determinational dissolution; counting is inappropriate',
    candidateSummary: 'Determinations dissolve into each other; only representation isolates and counts; quantitative distinction is out of place.',
    clauses: [
      'assert(dissolvesIntoEachOther(["U","P","S"]))',
      'tag(Counting,"inappropriate-here")'
    ],
    predicates: [{ name: 'RejectCountingHere', args: [] }],
    relations: [
      { predicate: 'isolates', from: 'Representation', to: 'U|P|S' }
    ]
  },
  {
    id: 'con-sing-op-8-each-is-totality',
    chunkId: 'con-sing-8-negation-of-negation-totality',
    label: 'Negation of negation: each determination is the whole concept',
    candidateSummary: 'S grounds opposition in unity; positedness = being-in-and-for-itself; each distinct determination is the totality—determinateness = whole concept.',
    clauses: [
      'tag(Singularity,"negation-of-negation")',
      'assert(eachDeterminationIsTotality(["U","P","S"]))',
      'assert(determinateness == "whole-concept")'
    ],
    predicates: [{ name: 'EachDeterminationIsTotal', args: [] }],
    relations: [
      { predicate: 'grounds', from: 'Singularity', to: 'UnityOfOpposition' }
    ]
  },
  {
    id: 'con-sing-op-9-actuality-posited-abstraction',
    chunkId: 'con-sing-9-externalization-actuality',
    label: 'Singularity externalizes concept to actuality; fixes difference as determinate determinateness',
    candidateSummary: 'Immanent abstraction in U and P concretizes them as content (a singular); singularity as posited abstraction fixes difference and determines the particular.',
    clauses: [
      'assert(stepsIntoActuality(Concept, via: Singularity))',
      'assert(immanent(Abstraction, in:["Universal","Particular"]))',
      'assert(concretizes(Abstraction, ["Universal","Particular"], as:"content/singular"))',
      'tag(Singularity,"determinate-determinateness/posited-abstraction")',
      'assert(determines(Particular, by: Singularity))'
    ],
    predicates: [{ name: 'ExternalizesToActuality', args: [] }],
    relations: [
      { predicate: 'fixes', from: 'Singularity', to: 'Difference' }
    ]
  },
  {
    id: 'con-sing-op-10-exclusivity-and-commonality',
    chunkId: 'con-sing-10-this-exclusion-commonality',
    label: 'Singular as qualitative this: exclusivity; universal-as-commonality is lowest view',
    candidateSummary: 'Singular is qualitative this: repulsion presupposes many; negatively relates to others (exclusive). Universal viewed as mere commonality of indifferent singulars mixes immediacy of being into concept.',
    clauses: [
      'tag(Singular,"qualitative-this")',
      'assert(repulsionFromSelf(Singular) && presupposesMany(Singular))',
      'assert(exclusiveTowardsOthers(Singular) == true)',
      'annotate(UniversalAsCommonality,{status:"lowest-external-view", mixes:"immediacy-of-being"})'
    ],
    predicates: [{ name: 'MarksExclusivityCommonality', args: [] }],
    relations: [
      { predicate: 'refersAs', from: 'Universal', to: 'Commonality(Singulars)' }
    ]
  },
  {
    id: 'con-sing-op-11-this-vs-singular-mediation',
    chunkId: 'con-sing-11-this-vs-singular-mediation',
    label: '“This” needs external pointing; singular internalizes mediation',
    candidateSummary: '“This” = posited immediacy via external pointing (reflective mediation). Singular is immediate-as-mediated within itself: self-separating abstraction that is positive connection.',
    clauses: [
      'assert(positedImmediacy(This) && pointedAtBy(This, "external"))',
      'annotate(ReflectiveMovement,{role:"points-and-posits-immediacy"})',
      'assert(internalMediation(Singular) == true)',
      'tag(Singular,"repelling-separation + positive-connection")'
    ],
    predicates: [{ name: 'ContrastsThisAndSingular', args: [] }],
    relations: [
      { predicate: 'requires', from: 'This', to: 'ExternalPointing' },
      { predicate: 'contains', from: 'Singular', to: 'Mediation(Internal)' }
    ]
  },
  {
    id: 'con-sing-op-12-posits-essential-differences',
    chunkId: 'con-sing-12-posited-differences-essential-relation',
    label: 'Singularity posits self-subsisting differences; essential relation; excludes-yet-refers to U',
    candidateSummary: 'Act of abstraction (singularity) first posits differences as self-subsisting in essential relation (not mere plurality of being); excludes universal yet essentially refers to it.',
    clauses: [
      'assert(positsSelfSubsistingDifferences(Singularity))',
      'assert(essentialRelation(Differences) == true)',
      'assert(not merePlurality(Differences))',
      'assert(differenceOf(Concept))',
      'assert(excludesYetRefers(Singularity, Universal))'
    ],
    predicates: [{ name: 'PositsEssentialDifferences', args: [] }],
    relations: [
      { predicate: 'standsIn', from: 'Differences', to: 'EssentialRelation' },
      { predicate: 'excludes', from: 'Singularity', to: 'Universal' },
      { predicate: 'refersTo', from: 'Singularity', to: 'Universal' }
    ]
  },
  {
    id: 'con-sing-op-13-judgment-origin',
    chunkId: 'con-sing-13-judgment-emergence',
    label: 'Concept loses posited unity; determinate→totality; turning-back as originative partition = judgment',
    candidateSummary: 'With determinations self-subsisting, concept loses posited unity; singularity returns into itself so the determinate is totality. Turning-back is absolute, originative partition—concept posited as judgment.',
    clauses: [
      'assert(losesPositedUnity(Concept) == true)',
      'tag(Determinations,"self-subsistent/in-and-for-themselves")',
      'assert(becomesTotality(Determinate) == true)',
      'tag(Singularity,"absolute-originative-partition")',
      'tag(Result,"Judgment")'
    ],
    predicates: [{ name: 'EmergenceOfJudgment', args: [] }],
    relations: [
      { predicate: 'isPositedAs', from: 'Concept(turning-back-as-Singularity)', to: 'Judgment' }
    ]
  }
]

/* accessors */
export function getChunk(oneBasedIndex: number): Chunk | null {
  return CANONICAL_CHUNKS[oneBasedIndex - 1] ?? null
}
export function getLogicalOpsForChunk(oneBasedIndex: number): LogicalOperation[] {
  const chunk = getChunk(oneBasedIndex)
  if (!chunk) return []
  return LOGICAL_OPERATIONS.filter(op => op.chunkId === chunk.id)
}
